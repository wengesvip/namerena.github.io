<html>
<head>
	<style type="text/css">
		.left{
			width:300px;
		}
		.left>*{
			margin:10px;
			width:100%;
		}
		input{
			width:100%;
		}
		textarea{
			width:100%;
			min-height:500px;
		}
	</style>
    <script>
        var M=8,C=0,delay=1,all=0,gsize=1000;
        var pre="文鸽",team="文哥";
        var stk=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];
        var stat=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
        var is=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
        var res=["","","","","","","","","","","","","","","",""];
		var result_all="";
        function chk() {
            var W=function(n){return document.querySelectorAll('iframe')[n].contentWindow};
            var G=function(n){var s="";while(n--)s+=unescape("%u"+Number(Math.floor(Math.random()*(0x9fa5-0x4e00)+0x4e00)).toString(16));return s;}
            var x=C;C++;if(C==M)C=0;

            if(stat[x]==0) {
                var s="!test!\n\n";
                for(var i=1;i<=gsize;i++)s+=pre+G(3)+"@"+team+"\n";
                W(x).document.querySelector("#textdiv>textarea").value=s;
                W(x).document.querySelector(".goBtn").click();
                stat[x]=1;
                is[x]=1;
            } else if(stat[x]==1&&W(x).cw().document.querySelectorAll("span.u").length>=2) {
                var a=W(x).cw().document.querySelectorAll(".s_elite1");
                var n=a.length;
                for(var i=0; i<n; i++) {
                    stk[x].push(a[i].parentElement.previousElementSibling.textContent);
                }
                //console.log(names);
                all+=gsize;
                stat[x]=2;
                is[x]=0;
				document.querySelector(".count").value=all;
            } else {
                if(is[x]==0) {
                    if(stk[x].length!=0) {
                        var s=stk[x][stk[x].length-1];
                        res[x]=s+" ";
                        W(x).document.querySelector("#textdiv>textarea").value="!test!\n\n"+s;
                        W(x).document.querySelector(".goBtn").click();
                        is[x]=1;
                        stk[x].pop();
                    } else {
                        stat[x]=0;
                    }
                } else {
                    var a=W(x).cw().document.querySelectorAll("span.u");
                    var n=a.length;
                    if(n)if(a[n-1].textContent.search(/实力评估中...[1-9][1-9]%/)!=-1) {
                        res[x]+=W(x).cw().document.querySelectorAll("span.u")[10].textContent.split(" ")[2]+"\n";
                        is[x]=0;
                        console.log(res[x]);
						result_all+=res[x];
						document.querySelector(".result").value=result_all;
                    }
                }
            }
        }
        var si;
        function start(){
			team=document.querySelector(".team").value;
			pre=document.querySelector(".pre").value;
			M=document.querySelector(".number").value;
			delay=document.querySelector(".delay").value;
			document.querySelector(".start").disabled=true;
			for(var i=1;i<=M;i++){
				var NW = document.createElement('iframe'); 
				NW.src="https://wengesvip.github.io/namerena.github.io";  
				NW.hidden=true;
				document.body.appendChild(NW);
			}
            si=setInterval(function(){chk()},delay*1000);
        }
    </script>
</head>
<body>
	<div class="main">
		<div class="left">
			<div>战队<input type="text" class="team" value="战队名"></input></div>
			<div>前缀<input type="text" class="pre" value="前缀"></input></div>
			<div>多开（1-16）<input type="text" class="number" value="8"></input></div>
			<div>检查时间（秒）<input type="text" class="delay" value="1"></input></div>
			<button onclick="start()" class="start">开始</button>
			<div>测号计数<input type="text" class="count" value="0" readonly></input></div>
			<div>结果</div>
			<textarea class="result" placeholder="结果将会显示在这里" readonly></textarea>
		</div>
	</div>
</html>
